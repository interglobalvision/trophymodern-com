{"version":3,"sources":["main.js"],"names":["ThreeScene","models","init","_this","this","$container","$","scene","THREE","Scene","camera","PerspectiveCamera","window","innerWidth","innerHeight","raycaster","Raycaster","directionVector","Vector3","mousePosition","x","y","clicked","renderer","WebGLRenderer","antialias","setSize","setPixelRatio","devicePixelRatio","setClearColor","controls","OrbitControls","domElement","enableDamping","dampingFactor","enableZoom","append","ambient","AmbientLight","directionalLight","DirectionalLight","position","set","normalize","add","z","addSkybox","render","click","event","clientX","clientY","addEventListener","resize","bind","aspect","updateProjectionMatrix","testContent","geometry","BoxGeometry","material","MeshBasicMaterial","color","cube","Mesh","addModels","i","Models","length","addModel","model","Loader","Handlers","DDSLoader","loader","OBJMTLLoader","load","obj","mtl","object","onProgress","onError","xhr","lengthComputable","percentComplete","loaded","total","console","log","Math","round","dirPath","WP","themeUrl","skybox","makeSkybox","urls","size","skyboxCubemap","ImageUtils","loadTextureCube","format","RGBFormat","skyboxShader","ShaderLib","uniforms","value","ShaderMaterial","fragmentShader","vertexShader","depthWrite","side","BackSide","requestAnimationFrame","unproject","sub","intersects","intersectObjects","children","target","id","update","TrophyModern","document","ready","Swiper","keyboardControl","centeredSlides","spaceBetween","slidesPerView","hashnav","nextButton","prevButton","Layout","windowWidth","width","windowHeight","height","setWindowValues","logic","css","Speech","mute","speakContent","undefined","speakOnLoad","first","speechSynthesis","cancel","SpeechSynthesisUtterance","text","lang","rate","onend","speak","on","muteToggle","toggle","resume","pause","loadElement","selector"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, document, THREE, WP, Models, Swiper, speechSynthesis, SpeechSynthesisUtterance */\n\nvar ThreeScene = {\n  models: [],\n  init: function() {\n    var _this = this;\n\n    _this.$container = $('#three-scene');\n\n    _this.scene = new THREE.Scene();\n    _this.camera = new THREE.PerspectiveCamera(75, (window.innerWidth / window.innerHeight), 0.1, 8000);\n    _this.raycaster = new THREE.Raycaster();\n    _this. directionVector = new THREE.Vector3();\n\n    _this.mousePosition = {\n      x: 0,\n      y: 0,\n      clicked: false,\n    };\n\n    _this.renderer = new THREE.WebGLRenderer({\n      antialias: true,\n    });\n    _this.renderer.setSize(window.innerWidth, window.innerHeight);\n    _this.renderer.setPixelRatio(window.devicePixelRatio);\n    _this.renderer.setClearColor(0xffffff);\n\n    _this.controls = new THREE.OrbitControls(_this.camera, _this.renderer.domElement);\n    _this.controls.enableDamping = true;\n    _this.controls.dampingFactor = 0.95;\n    _this.controls.enableZoom = false;\n\n    _this.$container.append(_this.renderer.domElement);\n\n    var ambient = new THREE.AmbientLight(0x444444);\n    var directionalLight = new THREE.DirectionalLight(0xffeedd);\n\n    directionalLight.position.set(0, 0, 1).normalize();\n\n    _this.scene.add( ambient );\n    _this.scene.add( directionalLight );\n\n    _this.camera.position.z = 5;\n\n    _this.addSkybox();\n\n    _this.render();\n    \n    _this.$container.click( function(event) {\n      _this.mousePosition.x = event.clientX;\n      _this.mousePosition.y = event.clientY;\n      _this.mousePosition.clicked = true;\n    });\n\n    window.addEventListener('resize', _this.resize.bind(_this), false);\n\n  },\n\n  resize: function() {\n    var _this = this;\n\n    _this.camera.aspect = window.innerWidth / window.innerHeight;\n    _this.camera.updateProjectionMatrix();\n\n    _this.renderer.setSize( window.innerWidth, window.innerHeight );\n\n  },\n\n  testContent: function() {\n    var _this = this;\n\n    var geometry = new THREE.BoxGeometry(1, 1, 1);\n    var material = new THREE.MeshBasicMaterial( {color: 0x00ff00,} );\n\n    _this.cube = new THREE.Mesh(geometry, material);\n\n    _this.scene.add(_this.cube);\n\n  },\n\n  addModels: function() {\n    var _this = this;\n\n    // Models is declared inside the loop on index.php. It contains an array of objects.\n    for(var i = 0; i < Models.length; i++) {\n      _this.addModel( Models[i] );\n    }\n  },\n\n  addModel: function(model) {\n    var _this = this;\n\n    THREE.Loader.Handlers.add( /\\.dds$/i, new THREE.DDSLoader() );\n\n    var loader = new THREE.OBJMTLLoader();\n\n    loader.load( model.obj, model.mtl, function ( object ) {\n\n      // Hot to calculate/randomize positions ??\n      object.position.x = model.x;\n      object.position.y = model.y;\n      object.position.z = model.z;\n\n      //_this.models.push( object );\n      _this.scene.add( object );\n\n    }, _this.onProgress, _this.onError );\n  },\n\n  onProgress: function(xhr) {\n    var _this = this;\n\n    if ( xhr.lengthComputable ) {\n      var percentComplete = xhr.loaded / xhr.total * 100;\n\n      if (percentComplete === 100) {\n        console.log('Model loaded');\n      } else {\n        console.log( Math.round(percentComplete, 2) + '% downloaded' );\n      }\n    }\n  },\n\n  onError: function(xhr) {\n    var _this = this;\n\n    console.log('some error');\n    console.log('xhr:', xhr);\n  },\n\n  addSkybox: function() {\n    var _this = this;\n\n    var dirPath = WP.themeUrl + '/img/three/skybox/';\n    var skybox = _this.makeSkybox([\n      dirPath + 'back.jpg',\n      dirPath + 'front.jpg',\n      dirPath + 'top.jpg',\n      dirPath + 'bottom.jpg',\n      dirPath + 'right.jpg',\n      dirPath + 'left.jpg',\n    ], 2048 );\n\n    _this.scene.add(skybox);\n  },\n\n  makeSkybox: function(urls, size) {\n    var skyboxCubemap = THREE.ImageUtils.loadTextureCube( urls );\n\n    skyboxCubemap.format = THREE.RGBFormat;\n\n    var skyboxShader = THREE.ShaderLib['cube'];\n\n    skyboxShader.uniforms['tCube'].value = skyboxCubemap;\n\n    return new THREE.Mesh(\n      new THREE.BoxGeometry(size, size, size),\n      new THREE.ShaderMaterial({\n        fragmentShader : skyboxShader.fragmentShader, vertexShader : skyboxShader.vertexShader,\n        uniforms : skyboxShader.uniforms, depthWrite : false, side : THREE.BackSide,\n      })\n    );\n  },\n\n  render: function() {\n    var _this = this;\n\n    requestAnimationFrame(_this.render.bind(_this));\n\n/*\n    _this.cube.rotation.x += 0.001;\n    _this.cube.rotation.y += 0.0011;\n*/\n\n    if (_this.mousePosition.clicked) {\n      _this.mousePosition.clicked = false;\n\n      var x = ( _this.mousePosition.x / window.innerWidth ) * 2 - 1;\n      var y = -( _this.mousePosition.y / window.innerHeight ) * 2 + 1\n\n      _this.directionVector.set(x, y, 1);\n\n      _this.directionVector.unproject( _this.camera );\n\n      _this.directionVector.sub(_this.camera.position);\n      _this.directionVector.normalize();\n\n      _this.raycaster.set(_this.camera.position, _this.directionVector)\n\n      var intersects = _this.raycaster.intersectObjects(_this.scene.children, true);\n\n      if( intersects.length ) {\n        var target = intersects[0].object;\n        console.log(target.id);\n      }\n    }\n\n    _this.controls.update();\n    _this.renderer.render(_this.scene, _this.camera);\n\n  },\n};\n\nvar TrophyModern = {\n  init: function() {\n    $(document).ready(function () {\n      var mySwiper = new Swiper('.swiper-container', {\n        keyboardControl: true,\n        centeredSlides: true,\n        spaceBetween: 60,\n        slidesPerView: 'auto',\n        hashnav: true,\n        nextButton: '.swiper-next',\n        prevButton: '.swiper-prev',\n      });\n    });\n  },\n};\n\nTrophyModern.init();\n\nvar Layout = {\n  windowWidth: $(window).width(),\n  windowHeight: $(window).height(),\n  setWindowValues: function() {\n    this.windowWidth = $(window).width();\n    this.windowHeight = $(window).height();\n  },\n\n  init: function() {\n    var _this = this;\n\n    _this.logic();\n\n    $(window).resize(function() {\n      _this.setWindowValues();\n      _this.logic();\n    });\n  },\n\n  logic: function() {\n    $('#page-copy').css('min-height', this.windowHeight + 'px');\n  },\n};\n\nTrophyModern.Speech = {\n  mute: false,\n  speakContent: undefined,\n  init: function() {\n    var _this = this;\n    var speakOnLoad = $('.speak-on-load').first();\n\n    speechSynthesis.cancel();\n\n    if (!_this.mute && speakOnLoad.length) {\n      _this.speakContent = new SpeechSynthesisUtterance();\n      _this.speakContent.text = speakOnLoad.text();\n      _this.speakContent.lang = 'en-US';\n      _this.speakContent.rate = 1;\n      _this.speakContent.onend = function() {\n        _this.speakContent = undefined;\n        speechSynthesis.cancel();\n      };\n\n      _this.speak();\n    }\n\n    $('.nav-mute-toggle').on({\n      click: function() {\n        _this.muteToggle();\n      },\n    });\n\n  },\n\n  muteToggle: function() {\n    var _this = this;\n\n    $('.nav-mute-toggle').toggle();\n\n    if (_this.mute) {\n      _this.resume();\n      _this.mute = false;\n    } else {\n      _this.pause();\n      _this.mute = true;\n    }\n  },\n\n  loadElement: function(selector) {\n    var _this = this;\n\n    speechSynthesis.cancel();\n\n    _this.speakContent = new SpeechSynthesisUtterance();\n    _this.speakContent.text = $(selector).text();\n    _this.speakContent.lang = 'en-US';\n    _this.speakContent.rate = 1;\n    _this.speakContent.onend = function() {\n      _this.speakContent = undefined;\n      speechSynthesis.cancel();\n    };\n\n    if (!_this.mute) {\n      _this.speak();\n    }\n\n  },\n\n  speak: function() {\n    speechSynthesis.speak(this.speakContent);\n  },\n\n  pause: function() {\n    speechSynthesis.pause(this.speakContent);\n\n  },\n\n  resume: function() {\n    speechSynthesis.resume(this.speakContent);\n\n  },\n\n};\n\n$(document).ready(function () {\n  'use strict';\n\n  Layout.init();\n\n  TrophyModern.Speech.init();\n\n  ThreeScene.init();\n\n  if (typeof Models !== 'undefined') {\n    ThreeScene.addModels();\n  }\n\n});\n"],"sourceRoot":"/source/"}