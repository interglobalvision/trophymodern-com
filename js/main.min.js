var animationSpeed=700,ThreeScene={models:[],filesLength:void 0,filesLoaded:0,percentLoaded:0,init:function(){var e=this;0===ThreeScene.percentLoaded&&$("body.home").length&&$("#loading").show(),e.$container=$("#three-scene"),e.scene=new THREE.Scene,e.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,8e3),e.raycaster=new THREE.Raycaster,e.directionVector=new THREE.Vector3,e.mousePosition={x:0,y:0,clicked:!1},e.renderer=new THREE.WebGLRenderer({antialias:!0}),e.renderer.setSize(window.innerWidth,window.innerHeight),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setClearColor(16777215),e.controls=new THREE.OrbitControls(e.camera,e.renderer.domElement),e.controls.enableDamping=!0,e.controls.dampingFactor=.95,e.controls.enableZoom=!1,e.$container.append(e.renderer.domElement);var n=new THREE.AmbientLight(4473924),o=new THREE.DirectionalLight(16772829);if(o.position.set(0,0,1).normalize(),e.scene.add(n),e.scene.add(o),e.camera.position.z=5,e.addSkybox(),1==WP.isAdmin){var t=new THREE.AxisHelper(5);t.name="axes",t.scale.x=.5,t.scale.y=.5,t.scale.z=.5,e.scene.add(t)}e.render(),e.$container.click(function(n){e.mousePosition.clicked=!0}),e.$container.mousemove(function(n){e.mousePosition.x=n.clientX,e.mousePosition.y=n.clientY}),window.addEventListener("resize",e.resize.bind(e),!1)},resize:function(){var e=this;e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth,window.innerHeight)},reset:function(){var e=this;0===e.percentLoaded&&($("#loading").show(),e.addModels())},testContent:function(){var e=this,n=new THREE.BoxGeometry(1,1,1),o=new THREE.MeshBasicMaterial({color:65280});e.cube=new THREE.Mesh(n,o),e.scene.add(e.cube)},addModels:function(){var e=this;e.filesLength=2*Models.length;for(var n=0;n<Models.length;n++)e.addModel(Models[n],function(){e.filesLoaded++,e.percentLoaded=e.filesLoaded/e.filesLength*100,console.log("Files percent loaded",e.percentLoaded),100===e.percentLoaded?$("#loading").addClass("loaded"):$("#loading-overlay").css("width",100-Math.round(e.percentLoaded,2)+"%")})},addModel:function(e,n){var o=this;THREE.Loader.Handlers.add(/\.dds$/i,new THREE.DDSLoader);var t=new THREE.OBJMTLLoader;t.load(e.obj,e.mtl,function(n){n.url=e.url,n.position.x=e.position.x,n.position.y=e.position.y,n.position.z=e.position.z,n.rotation.y=e.rotation.y,o.scene.add(n)},function(e){o.onProgress(e,n)},o.onError)},onProgress:function(e,n){if(e.lengthComputable){var o=e.loaded/e.total*100;100===o?n():console.log("file "+e.currentTarget.responseURL+": "+Math.round(o,2)+"% downloaded")}},onError:function(e){console.log("some error"),console.log("xhr:",e)},addSkybox:function(){var e=this,n=WP.themeUrl+"/img/three/skybox/",o=e.makeSkybox([n+"back.jpg",n+"front.jpg",n+"top.jpg",n+"bottom.jpg",n+"right.jpg",n+"left.jpg"],2048);o.name="skybox",e.scene.add(o)},makeSkybox:function(e,n){var o=THREE.ImageUtils.loadTextureCube(e);o.format=THREE.RGBFormat;var t=THREE.ShaderLib.cube;return t.uniforms.tCube.value=o,new THREE.Mesh(new THREE.BoxGeometry(n,n,n),new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:t.uniforms,depthWrite:!1,side:THREE.BackSide}))},render:function(){var e=this;requestAnimationFrame(e.render.bind(e));var n=e.mousePosition.x/window.innerWidth*2-1,o=2*-(e.mousePosition.y/window.innerHeight)+1;e.directionVector.set(n,o,1),e.directionVector.unproject(e.camera),e.directionVector.sub(e.camera.position),e.directionVector.normalize(),e.raycaster.set(e.camera.position,e.directionVector);var t=e.raycaster.intersectObjects(e.scene.children,!0);if(t.length){var i=t[0].object;"skybox"!==i.name&&"axes"!==i.name?($("body").addClass("u-pointer"),i.parent.rotation.x+=2e-5*Math.sin(.001*(new Date).getTime())+.002,i.parent.rotation.y+=3e-5*Math.cos(.001*(new Date).getTime())+.002,i.parent.rotation.z+=2e-5*Math.sin(2e-4*(new Date).getTime())-.002,i.parent!==e.lastHovered&&(i.parent.traverse(function(e){e.material&&(e.material.opacity=.5,e.material.transparent=!0)}),e.lastHovered=i.parent),e.mousePosition.clicked&&(console.log("Going to: ",i.parent.url),TrophyModern.Ajaxy.ajaxLoad(i.parent.url))):($("body").removeClass("u-pointer"),e.lastHovered&&(i.parent.traverse(function(e){e.material&&(e.material.opacity=1,e.material.transparent=!0)}),e.lastHovered=!1)),e.mousePosition.clicked=!1}e.is404&&e.scene.children[3]&&(e.scene.children[3].rotation.x+=.005,e.scene.children[3].rotation.y+=.001,e.scene.children[3].rotation.z+=.003),e.controls.update(),e.renderer.render(e.scene,e.camera)},fourohfour:function(){_this=this;var e={name:"404",obj:WP.themeUrl+"/img/404.obj",mtl:WP.themeUrl+"/img/404.mtl",x:0,y:0,z:0};_this.addModel(e),_this.is404=!0}},TrophyModern={init:function(){new Swiper(".swiper-container",{keyboardControl:!0,centeredSlides:!0,spaceBetween:60,slidesPerView:"auto",nextButton:".swiper-next",prevButton:".swiper-prev"})}},Layout={windowWidth:$(window).width(),windowHeight:$(window).height(),setWindowValues:function(){this.windowWidth=$(window).width(),this.windowHeight=$(window).height()},init:function(){var e=this;e.logic(),e.setWindowValues(),$(window).resize(function(){e.setWindowValues(),e.logic()})},logic:function(){$("#page-copy").css("min-height",this.windowHeight+"px")},reset:function(){var e=this;$(window).off("resize"),e.init()}};TrophyModern.Email={$emailForm:null,init:function(){var e=this;e.$emailForm=$("#form-inquiries");var n=e.$emailForm.attr("action");e.$emailForm.on("submit",function(o){o.preventDefault(),e.onSubmit(),$.ajax({type:"POST",url:n,data:e.$emailForm.serialize(),success:function(n){1===n.code?e.onSuccess():e.onEmailError(n.code)},error:function(n,o,t){e.onAjaxError(n,o,t)}})})},onSubmit:function(){var e=this;e.$emailForm.css("background-color","gray"),$("#form-inquiries-submit").attr("disabled",!0).html("Sending...")},onSuccess:function(){$("#form-inquiries-inputs").hide(),$("#form-inquiries-output").show()},onEmailError:function(e){console.log(e)},onAjaxError:function(e,n,o){console.log(n),console.log(o),console.log(e)},reset:function(){var e=this;e.$emailForm.off(),e.init()}},TrophyModern.Speech={mute:!1,speakContent:void 0,speakOnLoad:void 0,init:function(){var e=this;$(".nav-mute-toggle").on({click:function(){e.muteToggle()}}),e.afterPageload()},afterPageload:function(){var e=this;e.speakOnLoad=$(".speak-on-load").first(),!e.mute&&e.speakOnLoad.length&&e.loadElement(e.speakOnLoad)},muteToggle:function(){var e=this;$(".nav-mute-toggle").toggle(),e.mute?(e.resume(),e.mute=!1):(e.pause(),e.mute=!0)},loadElement:function(e){var n=this;speechSynthesis.cancel(),n.speakContent=void 0,n.speakContent=new SpeechSynthesisUtterance,n.speakContent.text=e.text(),n.speakContent.lang="en-US",n.speakContent.rate=1,n.mute||n.speak()},speak:function(){speechSynthesis.speak(this.speakContent)},pause:function(){speechSynthesis.pause(this.speakContent)},resume:function(){speechSynthesis.resume(this.speakContent)}},TrophyModern.Ajaxy={init:function(){var e=this;e.$ajaxyLinks=$("a.ajax-link"),e.$elementsToHide=$(".nav, #main-container, #three-scene"),e.$ajaxyLinks.click(function(n){n.preventDefault();var o=n.currentTarget.href;e.ajaxLoad(o)}),window.onpopstate=function(){e.ajaxLoad(document.location.origin+document.location.pathname)}},reset:function(){var e=this;e.$ajaxyLinks.unbind("click"),e.init()},ajaxLoad:function(e){var n=this;$.ajax(e,{beforeSend:function(){n.ajaxBefore()},dataType:"html",error:function(e,o){n.ajaxErrorHandler(e,o)},success:function(o){n.ajaxSuccess(o,e)},complete:function(){n.ajaxAfter()}})},ajaxBefore:function(){var e=this;e.$elementsToHide.addClass("loading")},ajaxAfter:function(){var e=this;0===ThreeScene.percentLoaded&&$("body.home").length&&$("#loading").show(),e.$elementsToHide.removeClass("loading"),e.reset(),TrophyModern.init(),Layout.reset(),TrophyModern.Email.reset(),TrophyModern.Speech.afterPageload(),ThreeScene.reset(),$(".error404").length&&ThreeScene.fourohfour()},ajaxErrorHandler:function(e,n){alert(n),console.log(e)},ajaxSuccess:function(e,n){var o=document.createElement("html");o.innerHTML=e;var t=$("body",o).attr("class"),i=$("#main-container",o),r=$("title",o).text();history.pushState(null,r,n),document.title=r,$("#main-container").html(i.html()),$("body").removeAttr("class").addClass(t)}},$(document).ready(function(){"use strict";TrophyModern.init(),TrophyModern.Ajaxy.init(),TrophyModern.Email.init(),TrophyModern.Speech.init(),Layout.init(),ThreeScene.init(),"undefined"!=typeof Models&&ThreeScene.addModels(),$(".error404").length&&ThreeScene.fourohfour()});
//# sourceMappingURL=main.min.js.map
